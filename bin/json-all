#!/usr/bin/env ruby
# frozen_string_literal: true

require "json"
require "dorian-to_struct"

if ARGV.size != 1 || ARGV[0] == "--help" || ARGV[0] == "-h"
  abort "USAGE: ... | json-all CODE"
end

it = JSON.parse($stdin.each_line.to_a.map(&:strip).join("\n")).to_deep_struct

eval(ARGV.first)
